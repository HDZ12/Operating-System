# 3.1进程概念

## 程序的顺序执行与并发执行

### 程序的顺序执行

 静态概念，严格按次序执行的计算机操作序列的集合，体现了要求计算机完成相应功能时所应采取的顺序步骤.一个具有独立功能的程序独占处理机直到最终运行结束的过程。

**顺序性：**下一程序开始执行必须等到前一程序已完成

**封闭性：**最终结果由给定的初始条件决定，不受外界因
素影响。

**可再现性：**结果与执行速度，时间无关，只要给定相同的输入，无论何时重复执行，都得到相同结果

### 多道程序的并发执行

在时间上重叠，一个程序的执行尚未结束，另一个程序的执行已经开始

==**在并发执行的情况下导致结果的不确定性。**==

### 程序并发执行的特点

- **间断性：**“走走停停”，一个程序可能走到中途停下来，失去原有
的时序关系
- **失去程序的封闭性：**多个程序共享系统中的资源，资源状态由多个程序改变。
- **不可再现性：**外界环境在程序的两次执行期间发生变化，失去原有的
可重复特征。

### 程序并发执行所带来的特点：

- **优点：**1，提高资源利用率，2，提高系统的吞吐率
- **缺点：**1，加剧系统资源竞争，2，增加管理上的开销

### 进程的定义

进程是一个正在执行程序的实例，

包括程序计数器，寄存器的和变量的当前值

进程是执行的程序

包括程序计数器，寄存器，堆，栈，数据段
- 控制块(PCB)
- 数据段
- 程序段

- **描述性：**并发执行的程序在执行过程中，分配和管理资源的基本单位。

### 进程的特征

- **结构特征:** ***进程：*由程序段，数据段，进程控制块组成**
- **动态性：** ***由“创建”而产生，由“调度”而执行；由得不到资源而阻塞，由“撤消”而消亡。***
- **并发性： ** ***多个进程可同存于内存中，在一段时间内同时运行。***
- **独立性：*独立获得资源的基本单位***
- **异步性：** ***进程的执行顺序与执行时间的不确定性***

# 3.2进程与线程
## 什么是线程
- 进程的轻型实体，Thread，"轻量级进程"，是一系列活动按实现设点好的顺序依次执行的过程，是一系列指令的集合
- 是一条执行路径，不能单独存在，必须包含在进程中
- 线程是OS中运算调度的最小单位
## 为什么引入线程
- 提高操作系统并发性
## 线程属性
- 轻型实体
- 独立调度和分派的基本单位
- 可并发执行
- 共享进程资源

# 进程与线程对比
- 调度：基本单位线程
- 拥有资源：进程拥有资源。
- 并发性：都是为了提高并发性
- 系统开销：进程开销大
- 地址空间和其他资源：同一个进程的线程共享进程内存空间
- 通信：线程相互之间直接通信
# 线程实现方式
- 用户级线程
- 内核级线程
- 组合方式

# 进程状态
## 三种基本状态
- 就绪(Ready)
- 执行(Runnning)
- 阻塞(Blocked)![[1699691579354.png]]
- 创建
- 终止
# 进程控制
- 即OS对进程实现有效管理，包括创建新进程，撤销已有进程，挂起，阻塞和唤醒，进程切换等多种操作。OS通过原语(Primitive)操作实现进程控制
- 原语概念：
	- 能够完成特定功能程序，原子操作
- 原语特点：
	- 原子操作，要么全做，要么全不做，执行过程不会中断
	- 在管态/系统态/内核态下执行，常驻内存
	- 是内核三大支撑功能(中断处理/时钟管理/原语操作)
	- 创建：create
	- 阻塞：block
	- 唤醒：wakeup
	- 撤销：destory
- 挂起与激活：
	- 为了系统和用户观察分析进程
	- 挂起：suspend
	- 激活：active

# 进程调度
- 处理机调度
	- 根据一定算法和原则将处理及资源重新分配
- 前提：作业/进程数远远大于处理器数
- 目的：提高资源利用率，减少处理机空闲时间
- 调度程序：一方面要满足特定系统用户的需求，另一方面考虑系统整体效率和系统开销
- 调度层次：
	- 作业调度（高级调度）
	- 内存调度（中级调度）
	- 进程调度（低级调度）![[1699693044893.png]]
	- 抢占式调度：
		- 立即暂停当前进程
		- 分配处理机给另一个进程
		- 原则：优先权，短进程优先
	- 非抢占式调度
		- 若有进程请求执行
		- 等待直到当前进程完成或阻塞
		- 缺点：适用于批处理系统，不适用分时/实时系统
- 处理机调度：
	- 调度算法指标：
		- CPU利用率
		- 系统吞吐量
		- 周转时间
		- 等待时间
		- 响应时间
	- 调度算法
		- 作业调度：
			- FCFS（先来先服务，First come first servered）
				- 算法内容：调度作业、就绪队列中最先入队者，等待操作完成或阻塞
				- 算法原则：按作业/进程到达顺序执行
				- 调度方式：非抢占式
				- 适用场景：作业/进程调度
				- 优缺点
					- 有利于CPU繁忙的作业，充分利用
					- 不利于I/O繁忙的，操作耗时，其他饥饿
			- SJF(短作业优先，Shorest Job first)
				- 算法内容：所需服务时间最短的作业/进程优先服务
				- 算法原则：追去最少的平均(带权)周转时间
				- 调度方式SJF/SPF非抢占式
				- 优缺点
					- 平均等待/周转时间最少
					- 长作业周转时期会增加或饥饿
					- 估计时间不准确，不能保证紧迫任务及时处理
			- HRRN(高相应比优先调度，Highest Response Ratui Next)
				- 算法内容：结合FCFS，SJF综合考虑等待时间和服务时间计算响应比，高的优先调度
				- 算法原则：综合考虑作业/进程的等待时间和服务时间
				- 调度方式：非抢占式
				- 适用场景：作业/抢占调度
				- 响应比计算：
					- 响应比=（等待时间+服务时间）/服务时间>=1
					- 只有当前进程放弃执行权时，重新计算响应比
					- 长作业等待越久，响应比越高
			- PSA(优先级调度，Priority-Scheduling Algorithm)
				- 算法内容:又叫优先权调度，按作业/进程的优先级调度
				- 算法原则：优先级最高的作业.进程现调度
				- 调度方式:抢占/非抢占式
				- 优先级设置原则：
					- 静态/动态优先级
					- 系统>用户，交互性>非交互性，I/O>计算型
					- 低优先级可能会饥饿
		- 进程调度
			- RR(时间片轮转调度，Round-Robin)
				- 算法内容：按进程到达就绪顺序，轮流分配一个时间片，时间用完就剥夺
				- 算法原则：公平，轮流为每个进程服务，进程在一定时间内都能得到响应
				- 调度方式：抢占式、由时钟中断确定时间到
				- 使用场景：进程调度
				- 优缺点：
					- 公平，响应快，适用于分时系统
					- 时间片决定因素：系统响应时间，就绪队列进程数量，系统处理能力
					- 时间片太多相当于FCFS，太小，处理及频繁切换。开销增大
			- **MFQ(多级反馈队列调度，Multileveled Feedback Queue)**
				- 算法内容:设置多个按优先级排序的就绪队列。优先级从高到低，时间片，从小到大，新进程次啊用队列降级法：进入第一季队列，按FCFS分时间片，没有执行完，移到第二级，第三级。。前面队列不为空，不执行后续队列进程
				- 算法原则：集前几种算法优点，相当于PSA+RR
				- 调度方式：抢占式
				- 适用场景：进程调度
				- 优缺点：
					- 对各类型相对公平，快速响应
					- 终端型作业用户：短作业优先
					- 批处理用户：周转时期短
					- 长批处理用户：在前几个队列部分执行